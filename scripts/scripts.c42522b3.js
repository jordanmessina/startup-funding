"use strict";function sortByKey(a,b){return a.sort(function(a,c){var d=a[b],e=c[b];return d>e?-1:e>d?1:0})}var app=angular.module("fundingApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html"}).otherwise({redirectTo:"/"})}]);angular.module("fundingApp").factory("startupService",["$log",function(){var a={founders:[],convertibleNotes:[],equityRounds:[]};return a.addFounder=function(b){a.founders.push(b),a.founders=sortByKey(a.founders,"equity")},a.removeFounder=function(b){a.founders.splice(b,1)},a.foundersLength=function(){return a.founders.length},a.totalFounderEquity=function(){var b=0,c=a.founders.length;if(!c)return 0;for(var d=0;c>d;d++)b+=a.founders[d].equity;return b},a.addConvertibleNote=function(b){b.investors=[],a.convertibleNotes.push(b)},a.removeConvertibleNote=function(b){a.convertibleNotes.splice(b,1)},a.addInvestorToConvertibleNote=function(b,c){a.convertibleNotes[b].investors.push(c)},a.removeInvestorFromConvertibleNote=function(b,c){a.convertibleNotes[b].investors.splice(c,1)},a.totalSeedInvestmentRaised=function(){for(var b=0,c=a.convertibleNotes.length,d=0;c>d;d++)for(var e=a.convertibleNotes[d].investors.length,f=0;e>f;f++)b+=a.convertibleNotes[d].investors[f].amount;return b},a.addEquityRound=function(b){b.investors=[],a.equityRounds.push(b)},a.removeEquityRound=function(b){a.equityRounds.splice(b,1)},a.addInvestorToEquityRound=function(b,c){a.equityRounds[b].investors.push(c)},a.removeInvestorFromEquityRound=function(b,c){a.equityRounds[b].investors.splice(c,1)},a.totalRaised=function(){for(var b=a.totalSeedInvestmentRaised(),c=a.equityRounds.length,d=0;c>d;d++)for(var e=a.equityRounds[d].investors.length,f=0;e>f;f++)b+=a.equityRounds[d].investors[f].amount;return b},a.totalRaisedForRound=function(b){for(var c=a.equityRounds[b],d=c.investors.length,e=0,f=0;d>f;f++)e+=c.investors[f].amount;return e},a.calculateEquity=function(){var b=[],c=a.founders,d=a.convertibleNotes,e=a.equityRounds;if(0===e.length)return b;if(0===e[0].investors.length)return b;for(var f=e[0].preMoneyValuation,g=a.totalRaisedForRound(0),h=g/(g+f)*100,i=e[0].investors.length,j=0;i>j;j++){var k=e[0].investors[j];b.push({name:k.name+" - Series A",equity:k.amount/(g+f)*100})}for(var l=0,m=d.length,n=0;m>n;n++)for(var o=d[n].cap,p=d[n].discount,q=d[n].investors.length,j=0;q>j;j++){var k=d[n].investors[j],r=Math.max(k.amount*((100-p)/100)/f,k.amount/Math.min(o,f));r=r*((100-h)/100)*100,l+=r,b.push({name:k.name,equity:r})}for(var s=c.length,t=0;s>t;t++){var u=c[t],r=u.equity*((100-l)/100);r*=(100-h)/100,b.push({name:u.name,equity:r})}if(e.length>1)for(var v=e.length,w=1;v>w;w++)for(var q=e[w].investors.length,j=0;q>j;j++)b.push({name:e[w].investors[j].name,equity:"0"});return b=sortByKey(b,"equity")},a}]),angular.module("fundingApp").controller("FoundersCtrl",["$scope","$log","startupService",function(a,b,c){a.founders=c.founders,a.addFounder=function(){c.addFounder(a.newFounder),a.newFounder={}},a.removeFounder=function(a){c.removeFounder(a)},a.totalFounderEquity=c.totalFounderEquity}]).directive("startupFounders",function(){return{templateUrl:"templates/founders.html"}}),angular.module("fundingApp").controller("ConvertibleNotesCtrl",["$scope","$log","startupService",function(a,b,c){a.founders=c.founders,a.convertibleNotes=c.convertibleNotes,a.addConvertibleNote=function(){c.addConvertibleNote(a.newConvertibleNote),a.newConvertibleNote={}},a.removeConvertibleNote=function(a){c.removeConvertibleNote(a)},a.showInvestorList=null,a.toggleShowInvestorList=function(b){a.showInvestorList=b},a.addInvestorToConvertibleNote=function(b){c.addInvestorToConvertibleNote(b,a.investorToAddToConvertibleNote),a.investorToAddToConvertibleNote={},a.toggleShowInvestorList(null)},a.removeInvestorFromConvertibleNote=function(a,b){c.removeInvestorFromConvertibleNote(a,b)},a.totalSeedInvestmentRaised=c.totalSeedInvestmentRaised}]).directive("convertibleNotes",function(){return{templateUrl:"templates/convertiblenotes.html"}}),angular.module("fundingApp").controller("EquityRoundsCtrl",["$scope","$log","startupService",function(a,b,c){a.founders=c.founders,a.equityRounds=c.equityRounds,a.addEquityRound=function(){c.addEquityRound(a.newEquityRound),a.newEquityRound={}},a.removeEquityRound=function(a){c.removeEquityRound(a)},a.showInvestorList=null,a.toggleShowInvestorList=function(b){a.showInvestorList=b},a.addInvestorToEquityRound=function(b){c.addInvestorToEquityRound(b,a.investorToAddToEquityRound),a.investorToAddToEquityRound={},a.toggleShowInvestorList(null)},a.removeInvestorFromEquityRound=function(a,b){c.removeInvestorFromEquityRound(a,b)},a.totalRaised=c.totalRaised}]).directive("equityRounds",function(){return{templateUrl:"templates/equityrounds.html"}}),angular.module("fundingApp").controller("FinalEquityCtrl",["$scope","$log","startupService",function(a,b,c){a.equityHolders=[],a.equityRounds=c.equityRounds,a.$watch(function(){return c},function(){a.equityHolders=c.calculateEquity()},!0)}]).directive("finalEquity",function(){return{templateUrl:"templates/finalequity.html"}});